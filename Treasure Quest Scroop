local player = game.Players.LocalPlayer
local chr = player.Character
local Root = chr.HumanoidRootPart



pcall(function()
wait()
game:GetService("ReplicatedStorage").Lobby.Remotes.CreateSquad:FireServer(_G.Dungeon,_G.Difficulty, _G.Gamemode, "Solo")
wait()
game:GetService("ReplicatedStorage").Lobby.Remotes.StartGame:FireServer()
end)



wait(3)
game:GetService("ReplicatedStorage").Dungeon.Remotes.StartDungeon:FireServer()

coroutine.wrap(function()
pcall(function()
    while wait() do
        game:GetService("ReplicatedStorage").Shared.Remotes.Combat.BasicAttack:FireServer(Vector3.new(-3.57226634, 37.2761993, -89.5366364))
        game:GetService("ReplicatedStorage").Shared.Remotes.Combat.UseAbility:FireServer(Vector3.new(1.12238836, 22.0425358, -152.037415))
    end
end)
end)()

wait(3)
print("Starting")

coroutine.wrap(function()
    while wait() do
            pcall(function()
                for i,v in pairs(game.Workspace.Dungeon.Enemies:GetChildren()) do
                    while v.EvilHumanoid.Health > 0 and game.Players.LocalPlayer.Character.Humanoid.Health > 0 do
                        repeat
                        wait()
                        Root.CFrame = v.HumanoidRootPart.CFrame * CFrame.new(0,0,5)
                        until v.EvilHumanoid.Health <= 0
                    end
                end
            end)
        pcall(function()
        Root.CFrame = game.Workspace.Dungeon.Rooms.FinishRoom.Hitbox.Part.CFrame
        end)
    end
end)()
